<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>⚡ Centrale Météo Admin Pro+</title>
  <style>
    body { font-family: Arial; background:#111; color:#eee; }
    .card { background:#222; padding:15px; margin:10px; border-radius:8px; }
    .btn { background:#0a84ff; color:white; padding:10px 20px; border:none; border-radius:5px; cursor:pointer; }
    #logs { background:#000; padding:10px; height:250px; overflow-y:auto; }
    .ok { color:lightgreen; }
    .error { color:red; }
  </style>
</head>
<body>
  <h1>⚡ Centrale Nucléaire Météo – Admin Pro+</h1>

  <div class="card">
    <h2>🚀 Lancer un run global</h2>
    <button class="btn" onclick="launchRun()">Lancer le run complet</button>
  </div>

  <div class="card">
    <h2>📜 Logs en direct</h2>
    <div id="logs">[En attente d’un run...]</div>
  </div>

  <div class="card">
    <h2>⚠️ Alertes</h2>
    <div id="alerts">Chargement...</div>
  </div>

  <div class="card">
    <h2>👥 Utilisateurs</h2>
    <div id="users">Chargement...</div>
  </div>

  <script>
    async function launchRun() {
      await fetch("/api/manual/run", { method:"POST" });
    }

    async function refreshLogs() {
      const res = await fetch("/api/admin/logs");
      const logs = await res.json();
      const div = document.getElementById("logs");
      div.innerHTML = logs.map(l => 
        `<div class="${l.type==='error'?'error':'ok'}">[${l.timestamp}] ${l.msg}</div>`
      ).join("");
    }

    setInterval(refreshLogs, 2000);
  </script>
</body>
</html>
