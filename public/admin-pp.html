<!-- Chat J.E.A.N. -->
<section id="chat">
  <h3>💬 Chat J.E.A.N.</h3>
  <input type="text" id="chat-input" placeholder="Pose ta question...">
  <button id="chat-send">Envoyer</button>
  <p id="chat-response">⏳ En attente...</p>
</section>

<!-- Debug IA (masqué par défaut) -->
<section id="debug-ia" style="display:none; margin-top:15px;">
  <h3>🛠️ Debug Cohere</h3>
  <pre id="debug-content" style="background:#111; color:#0f0; padding:10px; border-radius:8px; max-height:200px; overflow:auto;"></pre>
</section>

<!-- Bouton toggle debug -->
<button id="toggle-debug" style="margin-top:10px;">Afficher debug IA</button>

<script>
  const chatInput = document.getElementById("chat-input");
  const chatSend = document.getElementById("chat-send");
  const chatResponse = document.getElementById("chat-response");
  const debugSection = document.getElementById("debug-ia");
  const debugContent = document.getElementById("debug-content");
  const toggleDebug = document.getElementById("toggle-debug");

  // Toggle affichage debug
  toggleDebug.addEventListener("click", () => {
    debugSection.style.display = debugSection.style.display === "none" ? "block" : "none";
  });

  chatSend.addEventListener("click", async () => {
    const message = chatInput.value;
    chatResponse.textContent = "⏳ J.E.A.N. réfléchit...";

    const res = await fetch("/api/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message }),
    });

    const data = await res.json();
    chatResponse.textContent = data.reply || "⚠️ Réponse indisponible";

    // Afficher debug brut si dispo
    if (data.debug) {
      debugContent.textContent = JSON.stringify(data.debug, null, 2);
    }
  });
</script>
