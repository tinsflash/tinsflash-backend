<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Centrale Nucléaire Météo - Admin</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #eee; padding: 20px; }
    h3 { margin-top: 30px; }
    h4 { margin: 10px 0; }
    div { margin: 5px 0; }
  </style>
</head>
<body>
  <h2>⚡ Centrale Nucléaire Météo - Admin Console</h2>

  <!-- Prévisions nationales -->
  <section id="national">
    <h3>🇧🇪🇫🇷🇱🇺 Prévisions nationales</h3>
    <div id="BE-forecast">⏳ Chargement Belgique...</div>
    <div id="FR-forecast">⏳ Chargement France...</div>
    <div id="LUX-forecast">⏳ Chargement Luxembourg...</div>
  </section>

  <script>
  async function loadForecast(country) {
    try {
      const res = await fetch(`/api/admin/forecasts/latest/${country}`);
      if (!res.ok) {
        document.getElementById(`${country}-forecast`).innerText = "❌ Pas de prévision dispo";
        return;
      }
      const data = await res.json();
      let html = `<h4>${country}</h4>`;
      if (data.zones?.length > 0) {
        data.zones.forEach(z => {
          html += `<div><b>${z.name}</b> : ${z.text} (${z.min}°C / ${z.max}°C, ${z.icon})</div>`;
        });
      } else {
        html += `<div>${data.text} (${data.icon})</div>`;
      }
      document.getElementById(`${country}-forecast`).innerHTML = html;
    } catch (err) {
      console.error("Erreur chargement forecast", err);
      document.getElementById(`${country}-forecast`).innerText = "⚠️ Erreur chargement";
    }
  }

  window.onload = () => {
    ["BE","FR","LUX"].forEach(c => loadForecast(c));
  };
  </script>
</body>
</html>
