<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <title>Console Admin Pro+</title>
  <style>
    body { background: #111; color: #eee; font-family: Arial; padding: 20px; }
    h1 { color: #0ff; }
    .box { margin: 15px 0; padding: 15px; background: #222; border-radius: 10px; }
  </style>
</head>
<body>
  <h1>🌍 Console Admin Pro+</h1>
  <div class="box">
    <h2>🚀 Lancer un Run complet</h2>
    <button onclick="startRun()">Lancer maintenant</button>
    <p id="runStatus">[En attente...]</p>
  </div>
  <div class="box">
    <h2>⚠️ Alertes en attente (70–89 %)</h2>
    <div id="alerts">Chargement...</div>
  </div>
  <div class="box">
    <h2>👥 Utilisateurs par zone</h2>
    <div id="users">Chargement...</div>
  </div>
  <div class="box">
    <h2>📊 Statistiques Système</h2>
    <div id="stats">Chargement...</div>
  </div>

  <script>
    async function startRun() {
      document.getElementById("runStatus").innerText = "🚀 Lancement du run...";
      const res = await fetch("/api/supercalc/run", { method: "POST" });
      const data = await res.json();
      document.getElementById("runStatus").innerText = "✅ Run terminé : " + JSON.stringify(data);
    }

    async function loadStats() {
      const res = await fetch("/api/admin/stats");
      const stats = await res.json();
      document.getElementById("stats").innerText =
        `Prévisions en base: ${stats.forecasts}\n` +
        `Alertes en base: ${stats.alerts}\n` +
        `Uptime serveur: ${Math.round(stats.uptime / 60)} min`;
    }

    setInterval(loadStats, 5000);
    loadStats();
  </script>
</body>
</html>
