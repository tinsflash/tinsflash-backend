<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>‚ö° Centrale Nucl√©aire M√©t√©o ‚Äî Console Admin</title>
  <style>
    body {
      font-family: monospace, monospace;
      background: #0c0f16;
      color: #00ffc6;
      margin: 0;
      padding: 1rem;
    }
    h1 {
      color: #00ff84;
      text-align: center;
    }
    section {
      border: 1px solid #00ff84;
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
      background: #111522;
      box-shadow: 0 0 12px rgba(0, 255, 132, 0.3);
    }
    .card-title {
      font-weight: bold;
      margin-bottom: .5rem;
      font-size: 1.1rem;
    }
    .card-sub {
      font-size: .85rem;
      color: #ccc;
      margin-bottom: .5rem;
    }
    button {
      background: #00ffc6;
      color: #000;
      border: none;
      padding: .6rem 1.2rem;
      border-radius: 5px;
      cursor: pointer;
      margin: .3rem 0;
      font-weight: bold;
    }
    pre {
      background: #000;
      color: #0f0;
      padding: .7rem;
      border-radius: 5px;
      overflow-x: auto;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>‚ö° Centrale Nucl√©aire M√©t√©o ‚Äî Console Admin</h1>

  <!-- üöÄ Bouton Global -->
  <section>
    <div class="card-title">üöÄ D√©marrer TOUT (global)</div>
    <div class="card-sub">POST /api/run/global</div>
    <button id="btnRunAll">D√©marrer TOUT</button>
    <pre id="outRunAll"></pre>
  </section>

  <!-- üì° Logs -->
  <section>
    <div class="card-title">üì° Logs moteur</div>
    <div class="card-sub">GET /api/logs</div>
    <button id="btnLogs">Actualiser</button>
    <pre id="outLogs"></pre>
  </section>

  <!-- üõ†Ô∏è √âtat -->
  <section>
    <div class="card-title">üõ†Ô∏è √âtat du moteur</div>
    <div class="card-sub">GET /api/checkup</div>
    <button id="btnState">V√©rifier</button>
    <pre id="outState"></pre>
  </section>

  <!-- ‚úÖ Alertes -->
  <section>
    <div class="card-title">‚ö†Ô∏è Alertes m√©t√©o</div>
    <div class="card-sub">GET /api/alerts</div>
    <button id="btnAlerts">Charger</button>
    <pre id="outAlerts"></pre>
  </section>

  <!-- üåç Radar -->
  <section>
    <div class="card-title">üåç Radar m√©t√©o global</div>
    <div class="card-sub">GET /api/radar/global</div>
    <button id="btnRadar">Afficher</button>
    <pre id="outRadar"></pre>
  </section>

  <!-- ü§ñ Chat IA -->
  <section>
    <div class="card-title">ü§ñ Chat IA ‚Äî Moteur m√©t√©o nucl√©aire</div>
    <div class="card-sub">POST /api/chat</div>
    <textarea id="chatInput" rows="2" style="width:100%"></textarea><br/>
    <button id="btnChat">Envoyer</button>
    <pre id="outChat"></pre>
  </section>

  <script>
    async function callAPI(method, url, body) {
      const opts = { method, headers: { "Content-Type": "application/json" } };
      if (body && method !== "GET") opts.body = JSON.stringify(body);
      const r = await fetch(url, opts);
      const text = await r.text();
      try { return { status: r.status, json: JSON.parse(text) }; }
      catch { return { status: r.status, text }; }
    }

    // --- Run Global
    document.getElementById("btnRunAll").onclick = async () => {
      const out = document.getElementById("outRunAll");
      out.textContent = "‚è≥ Lancement du run global‚Ä¶";
      const res = await callAPI("POST", "/api/run/global");
      out.textContent = JSON.stringify(res.json ?? { error: res.text }, null, 2);
    };

    // --- Logs
    document.getElementById("btnLogs").onclick = async () => {
      const out = document.getElementById("outLogs");
      const res = await callAPI("GET", "/api/logs");
      out.textContent = JSON.stringify(res.json ?? { error: res.text }, null, 2);
    };

    // --- √âtat
    document.getElementById("btnState").onclick = async () => {
      const out = document.getElementById("outState");
      const res = await callAPI("GET", "/api/checkup");
      out.textContent = JSON.stringify(res.json ?? { error: res.text }, null, 2);
    };

    // --- Alertes
    document.getElementById("btnAlerts").onclick = async () => {
      const out = document.getElementById("outAlerts");
      const res = await callAPI("GET", "/api/alerts");
      out.textContent = JSON.stringify(res.json ?? { error: res.text }, null, 2);
    };

    // --- Radar
    document.getElementById("btnRadar").onclick = async () => {
      const out = document.getElementById("outRadar");
      const res = await callAPI("GET", "/api/radar/global");
      out.textContent = JSON.stringify(res.json ?? { error: res.text }, null, 2);
    };

    // --- Chat
    document.getElementById("btnChat").onclick = async () => {
      const out = document.getElementById("outChat");
      const msg = document.getElementById("chatInput").value;
      const res = await callAPI("POST", "/api/chat", { message: msg });
      out.textContent = JSON.stringify(res.json ?? { error: res.text }, null, 2);
    };
  </script>
</body>
</html>
