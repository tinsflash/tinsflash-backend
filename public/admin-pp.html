<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<meta name="robots" content="noindex,nofollow"/>
<title>ğŸš€ TINSFLASH PRO+++ â€¢ Cockpit Administrateur</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<style>
body{margin:0;background:#020b17;color:#e8f6ff;font-family:"Segoe UI",sans-serif;display:flex;min-height:100vh;}
nav{width:230px;background:#001027;flex-shrink:0;display:flex;flex-direction:column;padding:16px 0;border-right:1px solid #093c60;}
nav h1{color:#4fc3f7;text-align:center;margin:0 0 16px;font-size:1.1em;}
nav a{color:#aeeaff;text-decoration:none;padding:10px 20px;display:block;transition:.2s;}
nav a:hover{background:#032347;color:#fff;}
nav .active{background:#4fc3f7;color:#000;}
main{flex:1;padding:16px;overflow-y:auto;}
header{background:#001027;text-align:center;padding:14px;color:#4fc3f7;font-size:1.5em;text-shadow:0 0 10px #4fc3f7,0 0 20px #0288d1;margin-bottom:10px;border-radius:8px;}
h2{color:#4fc3f7;border-left:4px solid #4fc3f7;padding-left:10px;margin-top:30px;}
.phaseTitle{font-weight:bold;font-size:1.2em;color:#00ffcc;text-shadow:0 0 8px #00ffcc;margin:20px 0 8px;}
button{background:#071d34;color:#4fc3f7;border:1px solid #4fc3f7;padding:10px;margin:6px;border-radius:10px;font-weight:bold;cursor:pointer;display:flex;align-items:center;gap:6px;justify-content:center;transition:.2s;}
button:hover{background:#4fc3f7;color:#000;}
.btn-active{background:#22c55e;color:#000!important;animation:blink 1s infinite alternate;}
@keyframes blink{from{opacity:1;}to{opacity:.5;}}
.status-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px;}
.light{width:14px;height:14px;border-radius:50%;display:inline-block;margin-right:6px;}
.ok{background:#00ff88;box-shadow:0 0 8px #00ff88;}
.warn{background:#ffaa00;box-shadow:0 0 8px #ffaa00;}
.err{background:#ff4444;box-shadow:0 0 8px #ff4444;}
.idle{background:#555;}
.map{height:280px;margin-top:10px;border-radius:10px;overflow:hidden;}
.logs{background:#081527;border-radius:10px;padding:10px;height:340px;overflow-y:auto;font-family:monospace;font-size:13px;white-space:pre-wrap;border:1px solid #093c60;}
footer{text-align:center;font-size:13px;color:#555;margin:30px 0;}
@media(max-width:900px){body{flex-direction:column;}nav{width:100%;flex-direction:row;flex-wrap:wrap;justify-content:center;border-right:none;border-bottom:1px solid #093c60;background:#001027;padding:8px 0;}nav h1{width:100%;text-align:center;font-size:1em;margin-bottom:6px;}nav a{padding:6px 10px;font-size:0.9em;margin:2px;border-radius:6px;background:#02132d;}main{padding:10px;}}
</style>
</head>
<body>

<script>
if(!sessionStorage.getItem("tinsflashPIN")){
 const p=prompt("Code dâ€™accÃ¨s admin ?");
 if(p!=="202679"){alert("AccÃ¨s refusÃ©");location.href="/";}
 else sessionStorage.setItem("tinsflashPIN","ok");
}
</script>

<nav>
<h1>ğŸ›°ï¸ TINSFLASH PRO+++<br/>Menu Admin</h1>
<a href="/admin-pp.html" class="active">ğŸ  Tableau principal</a>
<a href="/admin-alerts.html">ğŸš¨ Alertes</a>
<a href="/admin-radar.html">ğŸŒ¦ï¸ Radar IA</a>
<a href="/admin-news.html">ğŸ“° ActualitÃ©s</a>
<a href="/admin-users.html">ğŸ‘¥ Utilisateurs</a>
<a href="/admin-chat.html">ğŸ’¬ Chat IA</a>
<a href="/cockpit.html">ğŸ§  Cockpit Standard</a>
<a href="/cockpit-pro.html">ğŸš€ Cockpit Pro</a>
<a href="/cockpit-proplus.html">ğŸ’ Pro+</a>
<a href="/premium.html">â­ Premium</a>
<a href="/provincenamur.html">ğŸ“ Province Namur</a>
<a href="/">â†©ï¸ Accueil public</a>
</nav>

<main>
<header>COCKPIT ADMINISTRATEUR â€“ IA J.E.A.N. â€“ Moteur Central</header>

<!-- PHASE 1 -->
<div class="phaseTitle">PHASE 1 â€“ Extraction des modÃ¨les traditionnels</div>
<div class="status-grid">
 <div><button onclick="run('global-europe')">ğŸ‡ªğŸ‡º Europe</button></div>
 <div><button onclick="run('global-usa')">ğŸ‡ºğŸ‡¸ USA / ğŸ‡¨ğŸ‡¦ Canada</button></div>
 <div><button onclick="run('afrique')">ğŸŒ Afrique</button></div>
 <div><button onclick="run('asie')">ğŸŒ Asie</button></div>
 <div><button onclick="run('oceanie')">ğŸŒŠ OcÃ©anie</button></div>
 <div><button onclick="run('ameriquesud')">ğŸŒ AmÃ©rique Sud</button></div>
 <div><button onclick="run('belgique')">ğŸ‡§ğŸ‡ª Belgique</button></div>
 <div><button onclick="run('bouke')">ğŸ“º BoukÃ© (Namur)</button></div>
</div>

<!-- PHASE 2 -->
<div class="phaseTitle">PHASE 2 â€“ Analyse IA J.E.A.N.</div>
<div class="status-grid">
 <div><button onclick="runAI()">ğŸ§  Lancer IA J.E.A.N.</button></div>
</div>

<!-- PHASE 3 -->
<div class="phaseTitle">PHASE 3 â€“ IA Externes (GraphCast / Pangu / CorrDiff / NowcastNet)</div>
<div class="status-grid">
 <div><button onclick="runAIExternal()">ğŸ§© ExÃ©cuter IA Externes</button></div>
</div>

<!-- PHASE 4 -->
<div class="phaseTitle">PHASE 4 â€“ Comparaison & Fusion IA internes / externes</div>
<div class="status-grid">
 <div><button onclick="runAICompare()">âš–ï¸ Comparer IA internes / externes</button></div>
</div>

<!-- PHASE 5 -->
<div class="phaseTitle">PHASE 5 â€“ Fusion et Alertes</div>
<div class="status-grid">
 <div><button onclick="runAlerts()">ğŸš¨ Fusionner les alertes</button></div>
 <div><button onclick="checkStatus()">ğŸ” VÃ©rifier moteur</button></div>
</div>

<!-- VIDÃ‰O -->
<div class="phaseTitle">ğŸ¬ GÃ‰NÃ‰RATION VIDÃ‰O IA J.E.A.N. NAMUR</div>
<div class="status-grid">
 <div><button onclick="generateVideoNamur()">ğŸ¬ GÃ©nÃ©rer vidÃ©o IA Namur</button></div>
</div>

<h2>ğŸ“Š Ã‰tat du moteur</h2>
<div id="status" class="status-grid">
 <div><span class="light idle" id="lightEngine"></span>Moteur</div>
 <div><span class="light idle" id="lightIA"></span>IA J.E.A.N.</div>
 <div><span class="light idle" id="lightIAext"></span>IA Externes</div>
 <div><span class="light idle" id="lightAlerts"></span>Alertes</div>
 <div><span class="light idle" id="lightDB"></span>MongoDB</div>
</div>

<h2>ğŸŒ Cartes â€“ PrÃ©visions & Alertes</h2>
<div id="mapForecast" class="map"></div>
<div id="mapAlerts" class="map"></div>

<h2>ğŸ“œ Logs en direct</h2>
<div id="logs" class="logs">Connexion en cours...</div>

<footer>Â© 2025 â€“ Centrale MÃ©tÃ©o IA TINSFLASH PRO+++ â€¢ Moteur J.E.A.N.</footer>
</main>

<script>
const logs=document.getElementById("logs");
function addLog(m){const l=`${new Date().toLocaleTimeString()} ${m}`;logs.textContent+="\n"+l;logs.scrollTop=logs.scrollHeight;}
function setLight(id,s){const e=document.getElementById(id);if(e)e.className="light "+s;}

// PHASE 1
async function run(z){event.target.classList.add("btn-active");addLog(`â–¶ï¸ run-${z}`);try{const r=await fetch(`/api/run-${z}`,{method:"POST"});const j=await r.json();if(j.success){addLog(`âœ… ${z} OK`);setLight("lightEngine","ok");}else{addLog(`âš ï¸ ${z}: ${j.error}`);setLight("lightEngine","warn");}}catch(e){addLog(`âŒ ${z}: ${e.message}`);setLight("lightEngine","err");}event.target.classList.remove("btn-active");checkStatus();}

// PHASE 2
async function runAI(){try{const r=await fetch("/api/runAI",{method:"POST"});if(r.ok){addLog("ğŸ§  IA J.E.A.N. OK");setLight("lightIA","ok");}else addLog("âš ï¸ Erreur IA J.E.A.N.");}catch(e){addLog("âŒ IA J.E.A.N.: "+e.message);}}

// PHASE 3
async function runAIExternal(){try{addLog("ğŸ§© IA externes...");const r=await fetch("/api/runAIExternal",{method:"POST"});const j=await r.json();if(j.success){addLog("âœ… IA externes OK");setLight("lightIAext","ok");}else{addLog("âš ï¸ IA externes: "+j.error);setLight("lightIAext","warn");}}catch(e){addLog("âŒ IA externes: "+e.message);setLight("lightIAext","err");}}

// PHASE 4
async function runAICompare(){try{addLog("âš–ï¸ Comparaison IA...");const r=await fetch("/api/runAICompare",{method:"POST"});const j=await r.json();if(j.success){addLog("âœ… Comparaison terminÃ©e: "+(j.result?.summary||"OK"));setLight("lightIAext","ok");}else{addLog("âš ï¸ Comparaison: "+j.error);setLight("lightIAext","warn");}}catch(e){addLog("âŒ Comparaison: "+e.message);setLight("lightIAext","err");}}

// PHASE 5
async function runAlerts(){try{const r=await fetch("/api/runWorldAlerts",{method:"POST"});if(r.ok){addLog("ğŸš¨ Fusion alertes OK");setLight("lightAlerts","ok");}else addLog("âš ï¸ Erreur fusion alertes");}catch(e){addLog("âŒ Alertes: "+e.message);}}

// VIDÃ‰O NAMUR
async function generateVideoNamur(){try{addLog("ğŸ¬ VidÃ©o IA Namur...");const r=await fetch("/api/generateNamurVideo",{method:"POST"});const j=await r.json();if(j.success)addLog("âœ… VidÃ©o gÃ©nÃ©rÃ©e.");else addLog("âš ï¸ VidÃ©o: "+j.error);}catch(e){addLog("âŒ VidÃ©o: "+e.message);}}

// STATUS
async function checkStatus(){try{const r=await fetch("/api/status");const s=await r.json();addLog("â„¹ï¸ Ã‰tat: "+JSON.stringify(s));setLight("lightEngine",s.status==="RUN_OK"?"ok":"warn");setLight("lightDB",s.db==="connected"?"ok":"err");if(s.checkup?.iaActive)setLight("lightIA","ok");if(s.checkup?.alerts)setLight("lightAlerts","ok");}catch(e){addLog("âŒ Status: "+e.message);}}

// LOGS LIVE
const evt=new EventSource("/api/logs");
evt.onmessage=e=>{try{const l=JSON.parse(e.data);addLog(l.message||e.data);}catch{addLog(e.data);}};

// CARTES
const mapF=L.map("mapForecast").setView([50,4],6);
const mapA=L.map("mapAlerts").setView([20,0],2);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(mapF);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(mapA);
async function loadForecasts(){try{const r=await fetch("/api/forecast?lat=50&lon=4");const d=await r.json();L.marker([d.lat||50,d.lon||4]).addTo(mapF).bindPopup(`${d.temperature||"--"}Â°C<br>${d.condition||""}`);}catch(e){addLog("âš ï¸ Forecast: "+e.message);}}
async function loadAlerts(){try{const r=await fetch("/api/alerts");const a=await r.json();a.forEach(x=>{if(x.lat&&x.lon)L.circle([x.lat,x.lon],{radius:60000,color:"red"}).addTo(mapA).bindPopup(`<b>${x.title||"Alerte"}</b><br>${x.zone||""}`);});}catch(e){addLog("âš ï¸ Alerts: "+e.message);}}
loadForecasts();loadAlerts();
</script>
</body>
</html>
