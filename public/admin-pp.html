<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>üõ∞Ô∏è Console Administrateur ‚Äì Mode NASA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { background:#0a0f1c; color:#0ff; font-family:Arial, sans-serif; margin:0; padding:0; }
    h1, h2 { text-align:center; text-shadow:0 0 10px #0ff; }
    .section { border:1px solid #0ff; border-radius:10px; margin:15px; padding:15px; background:#111a2d; box-shadow:0 0 15px #0ff3; }
    button { background:#0ff; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:bold; }
    button:hover { background:#0cc; }
    pre, .log-box { background:#000; color:#0f0; padding:10px; border-radius:8px; overflow:auto; max-height:200px; font-size:13px; }
    .error { color:red; font-weight:bold; }
    .ok { color:lime; font-weight:bold; }
    iframe { width:100%; height:300px; border:0; border-radius:10px; }
  </style>
</head>
<body>
  <h1>üõ∞Ô∏è Console Administrateur ‚Äì Mode NASA</h1>

  <!-- Supercalculateur -->
  <div class="section">
    <h2>‚ö° Supercalculateur M√©t√©o</h2>
    <button onclick="runForecast()">üöÄ Lancer un Run (manual)</button>
    <div id="forecastResult"></div>
  </div>

  <!-- Monitoring & Logs -->
  <div class="section">
    <h2>üìä Monitoring & Logs</h2>
    <button onclick="checkup()">üîç Rafra√Æchir √©tat</button>
    <pre id="checkupResult">Attente...</pre>
    <button onclick="loadLogs()">üìñ Charger logs</button>
    <div class="log-box" id="logsBox">Logs...</div>
  </div>

  <!-- Alertes -->
  <div class="section">
    <h2>üö® Alertes d√©tect√©es</h2>
    <button onclick="loadAlerts()">üîÑ Rafra√Æchir alertes</button>
    <pre id="alertsBox">En attente...</pre>
  </div>

  <!-- Pr√©visions Nationales -->
  <div class="section">
    <h2>üåç Pr√©visions Nationales BE / FR</h2>
    <button onclick="loadBulletin('BE')">üáßüá™ Belgique</button>
    <button onclick="loadBulletin('FR')">üá´üá∑ France</button>
    <pre id="bulletinBox">Bulletins m√©t√©o...</pre>
  </div>

  <!-- IA J.E.A.N -->
  <div class="section">
    <h2>ü§ñ IA J.E.A.N (moteur & expert m√©t√©o/climat)</h2>
    <textarea id="aiQuestion" placeholder="Posez une question..." rows="3" style="width:100%;"></textarea>
    <button onclick="askAI()">Envoyer</button>
    <pre id="aiResponse">R√©ponse IA...</pre>
  </div>

  <!-- Radar -->
  <div class="section">
    <h2>üì° Radar ‚Äì Vue admin</h2>
    <iframe src="/api/radar/Europe"></iframe>
    <small>Donn√©es r√©elles RainViewer (radar mondial), fond OpenStreetMap. 100% live.</small>
  </div>

  <!-- Actualit√©s m√©t√©o -->
  <div class="section">
    <h2>üì∞ Actualit√©s m√©t√©o (monde)</h2>
    <button onclick="loadNews()">üîÑ Rafra√Æchir</button>
    <div id="newsBox">Chargement...</div>
  </div>

  <!-- Utilisateurs -->
  <div class="section">
    <h2>üìà Utilisateurs (zones couvertes / non couvertes)</h2>
    <button onclick="loadUsers()">üîÑ Rafra√Æchir</button>
    <pre id="usersBox">En attente...</pre>
  </div>

  <script>
    // Run Forecast
    async function runForecast() {
      document.getElementById("forecastResult").innerText = "‚è≥ Run en cours...";
      try {
        const res = await fetch("/api/superforecast", { method:"POST" });
        const data = await res.json();
        document.getElementById("forecastResult").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("forecastResult").innerHTML = `<span class="error">Erreur Run: ${err}</span>`;
      }
    }

    // Logs
    async function loadLogs() {
      document.getElementById("logsBox").innerText = "‚è≥ Chargement logs...";
      try {
        const res = await fetch("/api/logs");
        const data = await res.json();
        document.getElementById("logsBox").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("logsBox").innerHTML = `<span class="error">Erreur logs: ${err}</span>`;
      }
    }

    // Checkup
    async function checkup() {
      document.getElementById("checkupResult").innerText = "‚è≥ V√©rification...";
      try {
        const res = await fetch("/api/checkup");
        const data = await res.json();
        document.getElementById("checkupResult").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("checkupResult").innerHTML = `<span class="error">Erreur checkup: ${err}</span>`;
      }
    }

    // Alertes
    async function loadAlerts() {
      document.getElementById("alertsBox").innerText = "‚è≥ Chargement alertes...";
      try {
        const res = await fetch("/api/alerts/Europe");
        const data = await res.json();
        document.getElementById("alertsBox").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("alertsBox").innerHTML = `<span class="error">Erreur alertes: ${err}</span>`;
      }
    }

    // Bulletin
    async function loadBulletin(zone) {
      document.getElementById("bulletinBox").innerText = `‚è≥ Bulletin ${zone}...`;
      try {
        const res = await fetch(`/api/bulletin/${zone}`);
        const data = await res.json();
        document.getElementById("bulletinBox").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("bulletinBox").innerHTML = `<span class="error">Erreur bulletin: ${err}</span>`;
      }
    }

    // Chat IA
    async function askAI() {
      const question = document.getElementById("aiQuestion").value;
      document.getElementById("aiResponse").innerText = "‚è≥ R√©ponse en cours...";
      try {
        const res = await fetch("/api/chat", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify({ question })
        });
        const data = await res.json();
        document.getElementById("aiResponse").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("aiResponse").innerHTML = `<span class="error">Erreur IA: ${err}</span>`;
      }
    }

    // News
    async function loadNews() {
      document.getElementById("newsBox").innerText = "‚è≥ Chargement news...";
      try {
        const res = await fetch("/api/news");
        const data = await res.json();
        let html = "<ul>";
        data.forEach(n => html += `<li><a href="${n.url}" target="_blank">${n.title}</a></li>`);
        html += "</ul>";
        document.getElementById("newsBox").innerHTML = html;
      } catch (err) {
        document.getElementById("newsBox").innerHTML = `<span class="error">Erreur news: ${err}</span>`;
      }
    }

    // Users
    async function loadUsers() {
      document.getElementById("usersBox").innerText = "‚è≥ Chargement utilisateurs...";
      try {
        const res = await fetch("/api/users");
        const data = await res.json();
        document.getElementById("usersBox").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("usersBox").innerHTML = `<span class="error">Erreur users: ${err}</span>`;
      }
    }
  </script>
</body>
</html>
