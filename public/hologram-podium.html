<!DOCTYPE html>
<html lang="fr">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>üèõÔ∏è Podium Floreffe ‚Äî IA J.E.A.N.</title>
<style>
body{margin:0;background:#000;color:#8fe1ff;text-align:center;font-family:Segoe UI}
h2{margin:10px 0;color:#00c3ff}
#status{font-size:1.1em;margin:10px 0}
canvas{width:100%;height:80vh;opacity:.3}
</style></head>
<body>
<h2>üèõÔ∏è D√¥me Floreffe ‚Äî Surveillance IA J.E.A.N.</h2>
<div id="status">Chargement radar continental...</div>
<canvas id="radar"></canvas>
// ==========================================================
// üß† R√©ception IA J.E.A.N. ‚Äì pr√©-alerte locale
// ==========================================================
let banner;
function showJeanMessage(text){
  if(!banner){
    banner=document.createElement("div");
    banner.style.position="absolute";
    banner.style.top="10px";
    banner.style.right="10px";
    banner.style.padding="10px 15px";
    banner.style.background="rgba(0,255,180,0.1)";
    banner.style.border="1px solid #00ff99";
    banner.style.borderRadius="8px";
    banner.style.color="#8fe1ff";
    banner.style.fontSize="1em";
    banner.style.fontFamily="Segoe UI";
    banner.style.zIndex="50";
    document.body.appendChild(banner);
  }
  banner.textContent="üß† IA J.E.A.N. : "+text;
  banner.style.opacity="1";
  if(window.speechSynthesis){
    const utter=new SpeechSynthesisUtterance(text);
    utter.lang="fr-FR";
    speechSynthesis.cancel();
    speechSynthesis.speak(utter);
  }
  setTimeout(()=>{banner.style.transition="opacity 2s";banner.style.opacity="0";},12000);
}

// Branche sur le WebSocket existant
if(ws){
  const oldHandler=ws.onmessage;
  ws.onmessage=(msg)=>{
    try{
      const obj=JSON.parse(msg.data);
      if(obj.type==="jean_message") showJeanMessage(obj.text);
      else if(oldHandler) oldHandler(msg);
    }catch(e){console.warn(e.message);}
  };
}
 
<script type="module">
const c=document.getElementById("radar"),ctx=c.getContext("2d");
c.width=innerWidth;c.height=innerHeight*0.8;
async function draw(){
 try{
  const r=await (await fetch("./floreffe_radar.json?"+Date.now())).json();
  ctx.fillStyle="rgba(0,0,0,0.3)";
  ctx.fillRect(0,0,c.width,c.height);
  let closest=9999;
  for(const f of r.fronts){
    const x=(f.lon+5)*80,y=(52-f.lat)*80;
    ctx.fillStyle=`rgba(0,255,180,${0.4+Math.random()*0.3})`;
    ctx.beginPath();ctx.arc(x,y,15,0,Math.PI*2);ctx.fill();
    const d=Math.hypot(x-c.width/2,y-c.height/2);
    if(d<closest)closest=d;
  }
  const km=Math.round(closest/5);
  if(km<150){document.getElementById("status").innerHTML=`‚ö†Ô∏è Front pluvieux en approche : ${km} km du d√¥me.`;}
  else document.getElementById("status").innerHTML="‚úÖ Aucun front significatif √† proximit√©.";
 }catch(e){console.warn(e.message);}
 setTimeout(draw,600000);
}
draw();
</script>
</body></html>
