<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>⚡ Admin - Gestion Alertes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <style>
    body { background:#0d1117; color:#e6edf3; font-family:Arial,sans-serif; margin:0; }
    header { background:#161b22; padding:12px; text-align:center; font-size:20px; color:#00ff9d; font-weight:bold; }
    nav { display:flex; justify-content:center; gap:15px; background:#1f2937; padding:10px; }
    nav a { color:#9ca3af; text-decoration:none; padding:6px 12px; border-radius:6px; }
    nav a:hover { background:#374151; color:#fff; }
    .container { padding:20px; }
    .card { background:#161b22; border-radius:8px; padding:15px; margin-bottom:20px; }
    table { width:100%; border-collapse:collapse; }
    th,td { padding:8px; border-bottom:1px solid #374151; }
    th { text-align:left; color:#9ca3af; }
    button { padding:6px 12px; margin:2px; border:none; border-radius:5px; cursor:pointer; }
    .ok{color:#10b981;} .pending{color:orange;} .error{color:red;}
  </style>
</head>
<body>
  <header>⚡ Centrale Nucléaire Météo - Gestion Alertes</header>
  <nav>
    <a href="admin-pp.html">Cockpit</a>
    <a href="admin-alerts.html">Alertes</a>
    <a href="admin-chat.html">Chat IA</a>
    <a href="admin-radar.html">Radar</a>
    <a href="admin-index-preview.html">Index Preview</a>
    <a href="admin-users.html">Utilisateurs</a>
    <a href="admin-news.html">Infos Mondiales</a>
  </nav>

  <div class="container">
    <div class="card">
      <h3>Alertes en attente</h3>
      <table id="alertsTable">
        <thead>
          <tr><th>Date</th><th>Zone</th><th>Type</th><th>Confiance</th><th>Action</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    async function loadAlerts(){
      const res = await fetch("/api/alerts/pending");
      const data = await res.json();
      const tbody=document.querySelector("#alertsTable tbody");
      tbody.innerHTML="";
      (data.alerts||[]).forEach(a=>{
        tbody.innerHTML+=`
          <tr>
            <td>${a.date}</td>
            <td>${a.zone}</td>
            <td>${a.type}</td>
            <td>${a.confidence}%</td>
            <td>
              <button onclick="validate('${a.id}')">✅ Valider</button>
              <button onclick="wait('${a.id}')">⏳ Attente</button>
              <button onclick="reject('${a.id}')">❌ Rejeter</button>
            </td>
          </tr>`;
      });
    }
    async function validate(id){ await fetch("/api/alerts/validate/"+id,{method:"POST"}); loadAlerts(); }
    async function wait(id){ await fetch("/api/alerts/wait/"+id,{method:"POST"}); loadAlerts(); }
    async function reject(id){ await fetch("/api/alerts/reject/"+id,{method:"POST"}); loadAlerts(); }
    loadAlerts();
  </script>
</body>
</html>
