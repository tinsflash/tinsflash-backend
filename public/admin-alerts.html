<!DOCTYPE html>
<html lang="fr"><head><meta charset="utf-8"/><meta name="robots" content="noindex,nofollow"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ðŸš¨ Alertes â€“ TINSFLASH</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/><script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<style>
body{margin:0;font-family:Inter,system-ui;background:#0b1220;color:#e6f6ff}
header{padding:12px;text-align:center;background:#08121d;color:#6bf3ff;font-weight:700}
nav{display:flex;justify-content:center;gap:10px;padding:8px;background:#0d1624}
a{color:#4fc3f7;text-decoration:none;font-weight:600}
.map{height:420px;margin:10px;border-radius:8px}
.alert-group{margin:12px;padding:10px;background:#111a2b;border-radius:8px}
.alert{margin:6px 0;padding:6px;border-left:4px solid #4fc3f7}
</style></head>
<body>
<script>const PIN_ADMIN="202679";if(!sessionStorage.getItem("tinsflashPIN")){const p=prompt("Code dâ€™accÃ¨s admin ?");if(p!==PIN_ADMIN){alert("AccÃ¨s refusÃ©");location.href="/";}sessionStorage.setItem("tinsflashPIN","ok");}</script>
<header>ðŸš¨ Gestion des Alertes</header>
<nav>
<a href="/admin-pp.html">Console</a><a href="/admin-alerts.html">Alertes</a><a href="/admin-chat.html">Chat</a><a href="/admin-radar.html">Radar</a>
<a href="/admin-local.html">Local</a><a href="/admin-index.html">Index</a><a href="/admin-news.html">News</a><a href="/admin-users.html">Utilisateurs</a>
</nav>
<div class="map" id="map"></div>
<div class="alert-group"><h3>Alertes primeur (70â€“100 %)</h3><div id="primeur"></div></div>
<div class="alert-group"><h3>Alertes auto > 90 %</h3><div id="auto"></div></div>
<div class="alert-group"><h3>Alertes 70â€“89 %</h3><div id="analyse"></div></div>
<div class="alert-group"><h3>Alertes < 70 %</h3><div id="surv"></div></div>
<script>
let map=L.map("map").setView([20,0],2);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
async function load(){
const r=await fetch("/api/alerts").then(r=>r.json()).catch(()=>[]);
r.forEach(a=>{if(a.lat)L.marker([a.lat,a.lon]).addTo(map).bindPopup(a.title||a.event||"Alerte")});
const p=a=>a.confidence>=0.7&&a.confidence<=1;
document.getElementById("primeur").innerHTML=r.filter(p).map(a=>`<div class='alert'><b>${a.title}</b> â€“ ${(a.confidence*100).toFixed(0)}%</div>`).join("");
}
load();
</script></body></html>
