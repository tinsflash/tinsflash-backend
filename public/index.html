<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>ğŸŒ Centrale NuclÃ©aire MÃ©tÃ©o â€“ Vitrine</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { background:#0a0f1c; color:#0ff; font-family:Arial, sans-serif; margin:0; padding:0; }
    h1, h2 { text-align:center; text-shadow:0 0 10px #0ff; }
    .section { border:1px solid #0ff; border-radius:10px; margin:15px; padding:15px; background:#111a2d; box-shadow:0 0 15px #0ff3; }
    button { background:#0ff; border:none; padding:8px 16px; border-radius:8px; cursor:pointer; font-weight:bold; }
    button:hover { background:#0cc; }
    pre, .box { background:#000; color:#0f0; padding:10px; border-radius:8px; overflow:auto; font-size:13px; }
    .error { color:red; font-weight:bold; }
    .ok { color:lime; font-weight:bold; }
    iframe { width:100%; height:300px; border:0; border-radius:10px; }
    .forecast-grid { display:grid; grid-template-columns: repeat(auto-fill,minmax(120px,1fr)); gap:10px; }
    .forecast-card { background:#0c162a; border-radius:8px; padding:10px; text-align:center; box-shadow:0 0 8px #0ff3; }
    .ads { margin:10px auto; text-align:center; background:#222; padding:8px; border-radius:8px; }
  </style>
</head>
<body>
  <h1>ğŸŒ Centrale NuclÃ©aire MÃ©tÃ©o</h1>
  <h2>Les prÃ©visions et alertes les plus pointues du monde</h2>

  <!-- Google Ads -->
  <div class="ads">
    [Espace rÃ©servÃ© Google Adsense â€“ Bandeau pub]
  </div>

  <!-- PrÃ©visions locales -->
  <div class="section">
    <h2>ğŸ“ PrÃ©visions locales</h2>
    <button onclick="getLocalForecast()">ğŸ”„ RafraÃ®chir avec ma position</button>
    <pre id="localForecast">En attente gÃ©olocalisation...</pre>
  </div>

  <!-- PrÃ©visions nationales -->
  <div class="section">
    <h2>ğŸ‡§ğŸ‡ªğŸ‡«ğŸ‡· PrÃ©visions Nationales (BE / FR)</h2>
    <button onclick="getBulletin('BE')">ğŸ‡§ğŸ‡ª Belgique</button>
    <button onclick="getBulletin('FR')">ğŸ‡«ğŸ‡· France</button>
    <pre id="nationalForecast">Cliquez pour voir les bulletins...</pre>
  </div>

  <!-- PrÃ©visions 7 jours -->
  <div class="section">
    <h2>ğŸ“… PrÃ©visions 7 jours</h2>
    <div class="forecast-grid" id="weekForecast">Chargement...</div>
  </div>

  <!-- Alertes mÃ©tÃ©o -->
  <div class="section">
    <h2>ğŸš¨ Alertes mÃ©tÃ©o</h2>
    <button onclick="getAlerts()">ğŸ”„ RafraÃ®chir alertes</button>
    <pre id="alertsBox">En attente...</pre>
  </div>

  <!-- Bulletin mÃ©tÃ©o -->
  <div class="section">
    <h2>ğŸ“° Bulletin mÃ©tÃ©o automatique</h2>
    <pre id="bulletinBox">Chargement...</pre>
  </div>

  <!-- Radar -->
  <div class="section">
    <h2>ğŸ“¡ Radar mÃ©tÃ©o global</h2>
    <iframe src="/api/radar/Europe"></iframe>
    <small>Radar interactif basÃ© sur RainViewer / OpenStreetMap. 100% live.</small>
  </div>

  <!-- ActualitÃ©s mÃ©tÃ©o -->
  <div class="section">
    <h2>ğŸ“° ActualitÃ©s mÃ©tÃ©o (monde)</h2>
    <button onclick="getNews()">ğŸ”„ RafraÃ®chir</button>
    <div id="newsBox">Chargement...</div>
  </div>

  <!-- Upgrade -->
  <div class="section">
    <h2>âœ¨ Passez Premium</h2>
    <p>Pour dÃ©bloquer : radar avancÃ©, prÃ©visions ultra-dÃ©taillÃ©es, IA experte mÃ©tÃ©o, et alertes avant tout le monde.</p>
    <button>ğŸ’ Devenir Premium</button>
  </div>

  <script>
    // PrÃ©visions locales
    async function getLocalForecast() {
      document.getElementById("localForecast").innerText = "â³ Chargement...";
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async pos => {
          try {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            const res = await fetch(`/api/localforecast/${lat}/${lon}`);
            const data = await res.json();
            document.getElementById("localForecast").innerText = JSON.stringify(data, null, 2);
          } catch (err) {
            document.getElementById("localForecast").innerHTML = `<span class="error">Erreur: ${err}</span>`;
          }
        });
      } else {
        document.getElementById("localForecast").innerText = "âŒ GÃ©olocalisation non supportÃ©e.";
      }
    }

    // PrÃ©visions nationales
    async function getBulletin(zone) {
      document.getElementById("nationalForecast").innerText = `â³ Bulletin ${zone}...`;
      try {
        const res = await fetch(`/api/bulletin/${zone}`);
        const data = await res.json();
        document.getElementById("nationalForecast").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("nationalForecast").innerHTML = `<span class="error">Erreur: ${err}</span>`;
      }
    }

    // PrÃ©visions 7 jours (par dÃ©faut sur Belgique)
    async function getWeekForecast() {
      const grid = document.getElementById("weekForecast");
      grid.innerHTML = "â³ Chargement...";
      try {
        const res = await fetch(`/api/forecast/BE`);
        const data = await res.json();
        grid.innerHTML = "";
        data.forEach(day => {
          grid.innerHTML += `
            <div class="forecast-card">
              <b>${day.date}</b><br>
              ${day.icon}<br>
              ğŸŒ¡ï¸ ${day.min}Â°C / ${day.max}Â°C<br>
              ğŸŒ§ï¸ ${day.rain}%<br>
              ğŸ’¨ ${day.wind} km/h<br>
              ğŸ“Š FiabilitÃ©: ${day.confidence}%
            </div>`;
        });
      } catch (err) {
        grid.innerHTML = `<span class="error">Erreur: ${err}</span>`;
      }
    }

    // Alertes
    async function getAlerts() {
      document.getElementById("alertsBox").innerText = "â³ Chargement...";
      try {
        const res = await fetch(`/api/alerts/Europe`);
        const data = await res.json();
        document.getElementById("alertsBox").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("alertsBox").innerHTML = `<span class="error">Erreur: ${err}</span>`;
      }
    }

    // Bulletin automatique
    async function getBulletinAuto() {
      document.getElementById("bulletinBox").innerText = "â³ Chargement...";
      try {
        const res = await fetch(`/api/bulletin/BE`);
        const data = await res.json();
        document.getElementById("bulletinBox").innerText = JSON.stringify(data, null, 2);
      } catch (err) {
        document.getElementById("bulletinBox").innerHTML = `<span class="error">Erreur: ${err}</span>`;
      }
    }

    // News
    async function getNews() {
      document.getElementById("newsBox").innerText = "â³ Chargement...";
      try {
        const res = await fetch("/api/news");
        const data = await res.json();
        let html = "<ul>";
        data.forEach(n => html += `<li><a href="${n.url}" target="_blank">${n.title}</a></li>`);
        html += "</ul>";
        document.getElementById("newsBox").innerHTML = html;
      } catch (err) {
        document.getElementById("newsBox").innerHTML = `<span class="error">Erreur: ${err}</span>`;
      }
    }

    // Auto load on start
    getWeekForecast();
    getBulletinAuto();
    getAlerts();
    getNews();
  </script>
</body>
</html>
