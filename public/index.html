<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex,nofollow">
  <title>TINSFLASH ‚Äì M√©t√©o intelligente IA</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body { margin:0; font-family: 'Segoe UI', sans-serif; background:#0b0f19; color:#fff; }
    h2 { color:#4fc3f7; margin-top:20px; }
    section { background:#111831; padding:15px; border-radius:10px; margin:15px; }
    video { width:100%; height:200px; object-fit:cover; border-bottom:3px solid #4fc3f7; }
    .forecast-container { display:flex; overflow-x:auto; gap:10px; padding:10px 0; }
    .forecast-card { background:#1a2238; padding:10px; border-radius:8px; min-width:90px; text-align:center; }
    .forecast-card img { width:40px; }
    iframe { width:100%; height:320px; border:none; border-radius:8px; }
    footer { background:#111831; padding:20px; text-align:center; font-size:13px; color:#bbb; margin-top:30px; }
    footer a { color:#4fc3f7; text-decoration:none; }
    #jean-avatar { position:fixed; bottom:80px; right:20px; width:90px; cursor:pointer; z-index:1000; transition:transform 0.3s; }
    #jean-avatar:hover { transform:scale(1.1); }
    #chat-box { display:none; position:fixed; bottom:160px; right:20px; background:#111831; width:300px; border-radius:10px; border:1px solid #4fc3f7; box-shadow:0 0 20px rgba(79,195,247,0.3); }
    #chat-box header { background:#4fc3f7; color:#000; padding:8px; text-align:center; font-weight:bold; border-radius:10px 10px 0 0; }
    #chat-messages { height:200px; overflow-y:auto; padding:8px; font-size:14px; }
    .msg { margin:5px 0; padding:6px; border-radius:6px; }
    .user { background:#4fc3f7; color:#000; text-align:right; }
    .bot { background:#222; color:#fff; text-align:left; }
    #chat-input { display:flex; border-top:1px solid #333; }
    #chat-input input { flex:1; padding:8px; border:none; outline:none; background:#0b0f19; color:#fff; }
    #chat-input button { background:#4fc3f7; border:none; padding:8px 12px; font-weight:bold; cursor:pointer; }
  </style>
</head>
<body>

  <!-- üé¨ Vid√©o bandeau -->
  <video autoplay muted loop playsinline>
    <source src="intro-jean.mp4" type="video/mp4">
  </video>

  <!-- üåç Introduction -->
  <section>
    <h2>üåç Bienvenue sur TINSFLASH</h2>
    <p style="text-align:justify;">
      TINSFLASH croise les mod√®les m√©t√©orologiques internationaux avec son
      <strong>syst√®me J.E.A.N.</strong>, une intelligence artificielle multi-sources
      de nouvelle g√©n√©ration d√©di√©e √† l‚Äôanalyse m√©t√©o-climatique.
      Gr√¢ce √† lui, tu b√©n√©ficies de <strong>pr√©visions locales et nationales ultra-fiables</strong>,
      ajust√©es en temps r√©el √† ta position, ainsi que <strong>d‚Äôalertes anticip√©es</strong>
      d√©tect√©es avant les autres.  
      TINSFLASH, c‚Äôest la nouvelle r√©f√©rence de la m√©t√©o assist√©e par IA.
    </p>
  </section>

  <!-- üìç Pr√©visions locales -->
  <section>
    <h2>üìç Pr√©visions locales du jour</h2>
    <div id="local-today" class="forecast-container"></div>
  </section>

  <!-- üì° Pr√©visions nationales -->
  <section>
    <h2>üå¶Ô∏è Pr√©visions nationales du jour</h2>
    <div id="national-today" class="forecast-container"></div>
  </section>

  <!-- üóìÔ∏è Pr√©visions sur 7 jours -->
  <section>
    <h2>üóìÔ∏è Pr√©visions locales ‚Äì 7 jours</h2>
    <div id="local-week" class="forecast-container"></div>
  </section>

  <section>
    <h2>üóìÔ∏è Pr√©visions nationales ‚Äì 7 jours</h2>
    <div id="national-week" class="forecast-container"></div>
  </section>

  <!-- üåç Cartes du monde -->
  <section>
    <h2>üó∫Ô∏è Carte mondiale des pr√©visions</h2>
    <div id="map-forecast" style="height:300px;border-radius:8px;"></div>
  </section>

  <section>
    <h2>‚ö†Ô∏è Carte mondiale des alertes</h2>
    <div id="map-alerts" style="height:300px;border-radius:8px;"></div>
  </section>

  <!-- üå¶Ô∏è Radar Windy -->
  <section>
    <h2>üì° Radar en direct</h2>
    <iframe src="https://embed.windy.com/embed2.html?lat=50.5&lon=4.5&zoom=5&level=surface&overlay=rain&menu=false&message=true&marker=true" loading="lazy"></iframe>
  </section>

  <!-- ü§ñ Avatar J.E.A.N -->
  <img id="jean-avatar" src="avatars/jean-default.png" alt="Assistant J.E.A.N" onclick="toggleChat()" />

  <!-- üí¨ Chat Cohere -->
  <div id="chat-box">
    <header>üí¨ J.E.A.N ‚Äì Assistant m√©t√©o</header>
    <div id="chat-messages"></div>
    <div id="chat-input">
      <input type="text" id="user-input" placeholder="Pose ta question..." />
      <button onclick="sendMessage()">Envoyer</button>
    </div>
  </div>

  <!-- üìú Footer -->
  <footer>
    ¬© 2025 TINSFLASH ‚Äì Tous droits r√©serv√©s<br>
    üì© <a href="mailto:skysnapia@gmail.com">skysnapia@gmail.com</a> |
    üì± <a href="https://wa.me/32473264477" target="_blank">+32 473 26 44 77</a><br>
    Partenariats & acquisitions bienvenus.
  </footer>

  <script>
    // === CARTES MONDIALES ===
    const mapForecast = L.map('map-forecast').setView([20,0], 2);
    const mapAlerts = L.map('map-alerts').setView([20,0], 2);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(mapForecast);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(mapAlerts);

    // === AVATAR CHAT ===
    function toggleChat() {
      const box = document.getElementById("chat-box");
      box.style.display = (box.style.display === "block") ? "none" : "block";
    }

    function addMsg(text, type="bot") {
      const box = document.getElementById("chat-messages");
      const div = document.createElement("div");
      div.className = "msg " + type;
      div.textContent = text;
      box.appendChild(div);
      box.scrollTop = box.scrollHeight;
    }

    async function sendMessage() {
      const input = document.getElementById("user-input");
      const text = input.value.trim();
      if (!text) return;
      addMsg(text, "user");
      input.value = "";

      try {
        const res = await fetch("/api/jean", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });
        const data = await res.json();
        addMsg(data.reply || "‚ö†Ô∏è Pas de r√©ponse", "bot");
      } catch (e) {
        addMsg("‚ö†Ô∏è Erreur : " + e.message, "bot");
      }
    }
  </script>
</body>
</html>
