<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>TINSFLASH ‚Äì Pr√©visions et Alertes M√©t√©o</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index,follow">
  <style>
    body{margin:0;font-family:Arial,sans-serif;background:#0d1117;color:#eee;line-height:1.6;}
    header{position:relative;height:40vh;overflow:hidden;}
    header video{width:100%;height:100%;object-fit:cover;}
    header .overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);display:flex;align-items:center;justify-content:center;}
    header h1{font-size:2rem;color:#00d8ff;text-align:center;}
    main{padding:20px;}
    h2{color:#00d8ff;margin-top:20px;}
    .forecast,.alerts{background:#161b22;padding:15px;border-radius:8px;margin:15px 0;}
    pre{background:#0d1117;color:#0f0;font-size:.9rem;padding:10px;border-radius:6px;overflow-x:auto;}
    iframe{width:100%;height:400px;border:none;border-radius:8px;}
    footer{text-align:center;font-size:.8rem;color:#888;padding:15px;background:#111;}
    .ads{margin:20px 0;text-align:center;}
  </style>
  <!-- ‚úÖ Google AdSense placeholder -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</head>
<body>

<header>
  <video autoplay muted loop id="introVideo">
    <source src="intro-jean.mp4" type="video/mp4">
  </video>
  <div class="overlay"><h1>üåç TINSFLASH ‚Äì Les pr√©visions et alertes m√©t√©o les plus pr√©cises du monde</h1></div>
</header>

<main>
  <section>
    <p>
      Gr√¢ce √† notre moteur <b>nucl√©aire m√©t√©o</b> et √† l‚ÄôIA J.E.A.N., 
      nous croisons les donn√©es de tous les mod√®les m√©t√©orologiques, du relief, 
      de l‚Äôaltitude, des rivi√®res et du climat. R√©sultat : 
      <b>les pr√©visions locales et nationales les plus fiables au monde</b> 
      et des alertes g√©n√©r√©es <b>avant tout le monde</b>. 
    </p>
  </section>

  <div class="ads">
    <!-- Bloc pub -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-xxxxxxxx"
         data-ad-slot="1234567890"
         data-ad-format="auto"></ins>
    <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
  </div>

  <section class="forecast">
    <h2>üìä Pr√©visions locales</h2>
    <div id="forecast">Chargement...</div>
  </section>

  <section class="alerts">
    <h2>üö® Alertes m√©t√©o</h2>
    <div id="alerts">Chargement...</div>
  </section>

  <h2>üõ∞Ô∏è Radar</h2>
  <iframe src="https://embed.windy.com/embed2.html?lat=50&lon=4&zoom=5&level=surface&overlay=rain&menu=&message=true&marker=true&calendar=now&pressure=&type=map&location=coordinates&detail=true&detailLat=50&detailLon=4&metricWind=default&metricTemp=default&radarRange=-1"></iframe>

</main>

<footer>
  ¬© 2025 TINSFLASH ‚Äì System J.E.A.N by Pydaris <br>
  üìß skysnapia@gmail.com | üì± WhatsApp +32 473 26 44 77
</footer>

<!-- Avatar J.E.A.N -->
<script src="https://unpkg.com/lottie-web@latest/build/player/lottie.min.js"></script>
<div id="avatar-jean" style="position: fixed; bottom: 20px; right: 20px; width: 120px; height: 120px; cursor: pointer; z-index: 9999;">
  <lottie-player 
    src="https://assets10.lottiefiles.com/packages/lf20_j1adxtyb.json"
    background="transparent"
    speed="1"
    loop
    autoplay>
  </lottie-player>
</div>

<script>
document.getElementById("avatar-jean").addEventListener("click", async () => {
  const q = prompt("Posez une question m√©t√©o √† J.E.A.N :");
  if(!q) return;
  const res = await fetch("/api/jean", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({message:q})
  });
  const data = await res.json();
  alert("J.E.A.N : " + (data.reply || "Pas de r√©ponse"));
});

// === Pr√©visions utilisateur via query ?city&country ===
const params = new URLSearchParams(window.location.search);
const city = params.get("city") || "Bruxelles";
const country = params.get("country") || "BE";

// ‚ö†Ô∏è TODO : remplacer par une vraie API g√©ocoding
let lat=50.8503, lon=4.3517;
if(city.toLowerCase()==="paris"){lat=48.8566;lon=2.3522;}
if(city.toLowerCase()==="new york"){lat=40.7128;lon=-74.0060;}

async function loadForecast(){
  try{
    const res = await fetch("/api/superforecast",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({lat,lon,country,region:city})
    });
    const data = await res.json();
    document.getElementById("forecast").innerHTML = "<pre>"+JSON.stringify(data,null,2)+"</pre>";
  }catch(e){
    document.getElementById("forecast").textContent="Erreur forecast: "+e.message;
  }
}

async function loadAlerts(){
  try{
    const res = await fetch("/api/alerts");
    const data = await res.json();
    document.getElementById("alerts").innerHTML = "<pre>"+JSON.stringify(data,null,2)+"</pre>";
  }catch(e){
    document.getElementById("alerts").textContent="Erreur alertes: "+e.message;
  }
}

loadForecast();
loadAlerts();
</script>
</body>
</html>
